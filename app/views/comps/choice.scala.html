@(field: Field, text: String, opts: Seq[qxsl.ruler.Section])

@import qxsl.extra.field.City
@import scala.jdk.CollectionConverters._

@sect=@{field("sect")}
@city=@{field("city")}

@sectOpts=@{opts.map(_.getName)}
@cityOpts=@{City.all("jarl").asScala.filter(_.getFullPath.size >= 2).map(_.getFullName)}

@style={form-control selectpicker custom-select @if(field.hasErrors){is-invalid}}

<div class="form-group row">
	<label for="@sect.id" class="col-md-1 col-form-label">@text</label>
	<div class="col">
		<select class="@style" id="@sect.id" name="@sect.name" data-size="10">
			<option class="blank" value="">不参加</option>
		@for(opt <- sectOpts) {
			<option value="@opt" @if(sect.value.contains(opt)){selected="selected"}>@opt</option>
		}
		</select>
	</div>
	<label for="@city.id" class="col-form-label">運用地</label>
	<div class="col">
		<select class="@style" id="@city.id" name="@city.name" data-size="10" data-live-search="true">
			<option class="blank" value="">未選択</option>
		@for(opt <- cityOpts) {
			<option value="@opt" @if(city.value.contains(opt)){selected="selected"}>@opt</option>
		}
		</select>
	</div>
</div>
<script type="text/javascript">
function switch_enabled_@{field.id}() {
	$('#@{city.id}').attr('disabled', !$('#@{sect.id}').val());
	$('#@{city.id}').selectpicker('refresh');
}
$(document).ready(switch_enabled_@field.id);
$('#@{sect.id}').change(switch_enabled_@field.id);
</script>
