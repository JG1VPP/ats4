@(record: Record)(implicit cfg: Configuration, req: RequestHeader=null, admin: Boolean=false)

@import comps._
@import java.time.format.DateTimeFormatter
@import qxsl.field._

@summ = @{Tables(record.file,record.sect).score}
@dfmt = @{DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss OOOO")}
@time(t: Time)=@{t.value.format(dfmt)}

@comps.frame(title="提出書類の確認", nav=if(admin) "admin" else "entry") {
@if(!admin) {
<div class="alert alert-success">
	下記の内容で受理しました。
	交信記録が正しく読み込まれたかご確認ください。
	訂正が必要な場合は期間内に限り再提出できます。
</div>
}
<div class="card mb-5">
	<h3 class="card-header border-bottom-0">@record.sect</h3>
	<table class="table">
		<tr>
			<th>呼出符号</th>
			<th>運用場所</th>
			<th>お名前</th>
			<th>ご住所</th>
			<th>メール</th>
		</tr>
		<tr>
			<td>@record.call</td>
			<td>@record.city</td>
			<td>@record.name</td>
			<td>@record.addr</td>
			<td><a href="mailto:@record.mail">@record.mail</a></td>
		</tr>
	</table>
@if(record.comm.nonEmpty) {
	<div class="card-footer">
		@record.comm
	</div>
}
</div>
<div class="card mb-5">
	<h3 class="card-header">暫定の得点</h3>
	<div class="card-body">
		<strong>@{summ.total}点</strong> (素点@summ.score 乗数@summ.mults)
	</div>
</div>
<div class="card mb-5">
	<h3 class="card-header border-bottom-0">有効な交信</h3>
	<table class="table table-hover">
		<tr>
			<th width="26%">交信日時</th>
			<th width="16%">相手局</th>
			<th width="16%">周波数帯</th>
			<th width="16%">通信方式</th>
			<th width="16%">運用地</th>
		</tr>
	@for(succ <- summ.accepted()) {
		<tr>
			<td>@{time(succ.item.get(classOf[Time]))}</td>
			<td>@{succ.item.get(classOf[Call])}</td>
			<td>@{succ.item.get(classOf[Band])}</td>
			<td>@{succ.item.get(classOf[Mode])}</td>
			<td>@{succ.item.getRcvd.get(classOf[Code])}</td>
		</tr>
	}
	</table>
</div>
<div class="card mb-5">
	<h3 class="card-header border-bottom-0">無効な交信</h3>
	<table class="table table-hover">
		<tr>
			<th width="26%">交信日時</th>
			<th width="16%">相手局</th>
			<th width="16%">周波数帯</th>
			<th width="16%">通信方式</th>
			<th width="16%">運用地</th>
		</tr>
	@for(fail <- summ.rejected()) {
		<tr>
			<td>@{time(fail.item.get(classOf[Time]))}</td>
			<td>@{fail.item.get(classOf[Call])}</td>
			<td>@{fail.item.get(classOf[Band])}</td>
			<td>@{fail.item.get(classOf[Mode])}</td>
			<td>@{fail.item.getRcvd.get(classOf[Code])}</td>
		</tr>
	}
	</table>
	<div class="card-footer">
		時間外の交信や部門外の周波数帯など、書類の不備により、得点計算の対象と認められない交信です。
	</div>
</div>
@if(admin) {
@accord(id="edit", title="内容の修正", header=3) {
<a class="btn btn-success" href="@routes.Admin.logs(record.id)">交信記録をダウンロードする</a>
<a class="btn btn-primary" href="@routes.Admin.form(record.id)">上の内容で提出ページを開く</a>
<a class="btn btn-danger" href="#deleteModal" data-toggle="modal">書類を削除する</a>
@helper.form(action=routes.Admin.elim(record.id)) {
@helper.CSRF.formField
<div class="modal" id="deleteModal">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">書類の削除</h4>
			</div>
			<div class="modal-body">
				<p>@record.call (@record.sect) を削除します。</p>
				<p class="text-danger">この操作は取り消せません。</p>
			</div>
			<div class="modal-footer">
				<button class="btn btn-danger" type="submit">削除する</button>
				<button class="btn btn-primary" data-dismiss="modal">削除しない</button>
			</div>
		</div>
	</div>
</div>
}
}
}
}
