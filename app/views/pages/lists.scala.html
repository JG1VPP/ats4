@()(implicit cfg: Configuration, db: Database, admin: Boolean=false)

@isLinked(record: Record)=@{admin && !record.sect.contains("総合部門")}
@toRecord(record: Record)={onclick="window.location='@routes.Proof.view(record.id)';"}

@comps.frame(title=if(admin) "管理画面" else "暫定結果", nav=if(admin) "admin" else "lists") {
@if(admin || !DeadLine.isOK || DeadLine.demo) {
<div class="alert alert-warning">
	掲載内容に誤りがある場合は、直ちに主催者に連絡してください。
	赤太字は暫定表彰局ですが、審査により失格することがあります。
</div>
@for(sect <- models.Sections.all) {
@if(Record.ofSect(sect.getName).nonEmpty) {
<div class="card mb-5">
	<h3 class="card-header d-flex align-items-center justify-content-between border-bottom-0">
		<span>@sect.getName</span>
		@if(admin) {
		<a class="btn btn-outline-success" href="@routes.Admin.file(None)"><i class="fas fa-download"></i></a>
		}
	</h3>
	<table class="table table-hover">
		<thead>
			<tr>
				<th width="10%">順位</th>
				<th width="20%">呼出符号</th>
				<th width="10%">素点</th>
				<th width="10%">乗数</th>
				<th width="10%">総得点</th>
				<th width="40%">運用地</th>
			</tr>
		</thead>
		<tbody>
			@for(record <- Record.ofSect(sect.getName).sortBy(-_.score)) {
			<tr class="link @if(record.award) {award}" @if(isLinked(record)) {@toRecord(record)}>
				<td>@{1 + record.place}</td>
				<td>@{record.call}</td>
				<td>@{record.calls}</td>
				<td>@{record.mults}</td>
				<td>@{record.score}</td>
				<td>@{record.city}</td>
			</tr>
			}
		</tbody>
	</table>
	<div class="card-footer">
		当該部門の登録者数の10%(小数点以下切捨て)に1を足した順位 (最大7位) までを表彰する。
	</div>
</div>
}
}
} else {
<div class="alert alert-info">
	受付期間の終了と同時に暫定結果を公表します。
</div>
}
}
